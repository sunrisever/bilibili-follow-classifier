# B站关注UP主分类系统

将B站关注的UP主自动分类到20个类别，并同步到B站关注分组，方便管理和浏览。

## 分类体系（20个类别）

| 类别 | 说明 |
|------|------|
| 考研 | 考研培训、复习 |
| AI学术/论文 | AI学术研究、论文解读、实验室 |
| AI产品/开源/新闻 | AI产品、开源项目、科技新闻 |
| AI网课/教程 | AI/ML学习课程、教程 |
| 编程/计算机 | 编程、计算机科学、算法 |
| 数学/物理 | 大学数学、物理教学（含期末、专升本） |
| 数码/科技/汽车 | 数码产品评测、汽车 |
| 电气/电子/自动化 | 电子电气、机器人、半导体 |
| 时政/地缘政治 | 时政评论、国际关系 |
| 财经/金融 | 财经、投资、商业 |
| 科普/人文 | 科普+历史人文（不含时政） |
| 形象提升/医美 | 穿搭、医美、形象设计 |
| 两性情感 | 情感、婚恋 |
| 户外探索 | 旅行、探险、地理 |
| 美食/探店 | 美食、探店 |
| 音乐/乐器 | 音乐、乐器演奏 |
| 影视/动漫 | 电影、动漫、有声小说 |
| 医学/健康 | 医学科普、健康、健身 |
| 校园生活/校园日常 | 大学官方号、学习陪伴、效率工具、求职 |
| 美女/颜值 | 美女UP主、颜值向内容 |

## 工作流程

```
新增UP主 → 采集信息 → 算法初分类 → 人工审核调整 → 同步到B站分组
```

### 1. 采集信息

脚本通过B站API获取每个UP主的：
- 个人主页信息（签名、官方认证）
- 视频合集/系列名称
- 最近30个视频标题
- 最近5个视频的标签
- 最近30个视频的投稿分区（typeid映射）
- 最近30篇专栏文章标题

### 2. 算法初分类

`classify.py` 通过以下规则自动分类：
1. **手动指定**（MANUAL字典）：优先级最高，已审核的UP主直接指定
2. **投稿分区映射**：B站视频分区 → 自定义类别（权重50）
3. **名称特征识别**：机器人→电气、半导体→电气、招聘→校园生活
4. **关键词评分**：对签名、合集、标签等文本做关键词匹配打分

### 3. 人工审核

算法分类准确率约90%，仍需人工审核调整。常见需要修正的情况：
- AI相关内容被归到编程/计算机（应细分到AI三个子类）
- 纯数学内容被归到编程（应归数学/物理）
- 招聘号、求职类被归到编程（应归校园生活）
- 时政类被归到科普/人文（应归时政/地缘政治）

## 使用方法

### 环境准备

```bash
pip install -r requirements.txt
```

在 `config.json` 中填写B站cookie信息。

### 新增UP主（最常用）

```bash
python add_new.py <mid>
```

脚本会自动：采集信息 → 算法分类 → 添加到分类结果 → 更新信息汇总

分类结果在 `分类结果.json` 中，如需调整直接编辑JSON文件，然后运行以下命令同步MD：

```bash
python -c "from add_new import save_md, load_classify_result; save_md(load_classify_result())"
```

### 全量重新采集

```bash
python fetch.py all
```

### 补充缺失投稿分区

```bash
python fetch.py zones
```

### 全量重新分类

```bash
python classify.py
```

注意：全量分类会覆盖现有分类结果，之前的人工调整会丢失。

### 重新生成信息汇总

```bash
python generate_info.py
```

### 同步到B站关注分组

将 `分类结果.json` 中的分类同步到B站账号的关注分组：

```bash
python sync_groups.py
```

脚本会自动：删除旧分组 → 创建新分组 → 批量分配UP主到对应分组

可选参数：
- `--dry-run`：试运行，只显示操作不实际执行
- `--category 分类名`：只同步指定分类（可多次使用）

```bash
# 试运行，查看将执行的操作
python sync_groups.py --dry-run

# 只同步指定分类
python sync_groups.py --category 考研 --category 编程/计算机
```

注意：B站分组名不支持特殊字符，`/` 会被自动去除（如 `编程/计算机` → `编程计算机`）。

## 文件说明

| 文件 | 说明 |
|------|------|
| `config.json` | B站API配置（cookie），**不要提交到git** |
| `fetch.py` | 信息采集模块（全量/增量/补充分区） |
| `classify.py` | 分类算法（关键词+规则+手动指定） |
| `add_new.py` | 增量添加UP主（采集+分类一条龙） |
| `generate_info.py` | 生成可读的信息汇总文本 |
| `sync_groups.py` | 将分类结果同步到B站关注分组 |
| `up主详细数据.json` | UP主详细数据（原始数据） |
| `up主信息汇总.txt` | UP主信息汇总（可读文本，供审核参考） |
| `分类结果.json` | 分类结果（程序读写） |
| `分类结果.md` | 分类结果（人工浏览，带B站链接） |

## 分类边界规则

- 考研培训/考研真题 → **考研**
- 期末复习/大学数学(非考研) → **数学/物理**
- AI相关内容细分为三类：学术/产品/教程
- 美女vlog不输出干货 → **美女/颜值**
- 穿搭/形象设计 → **形象提升/医美**
- 传统电路/电工/底层控制基础课 → **电气/电子/自动化**
- 大学官方号 → **校园生活**
- 大厂招聘号 → **校园生活**
- 直播陪伴学习 → **校园生活**
- 时政评论 → **时政/地缘政治**（不是科普/人文）
- 历史/文化故事 → **科普/人文**（不是时政）

## 注意事项

- B站API有频率限制，短时间大量请求会触发-352风控
- `config.json` 包含敏感cookie，已加入 `.gitignore`
- 全量分类会覆盖人工调整，建议只在初始化时使用
